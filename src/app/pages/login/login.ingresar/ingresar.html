<section class="min-vh-100 d-flex align-items-center justify-content-center">
  <div class="container">
    <div class="card border-light-subtle shadow-sm">
      <div class="row g-0 h-100">

        <!-- Columna izquierda -->
        <div class="col-12 col-md-6 bg-login-custom">
          <div class="d-flex align-items-center justify-content-center h-100">
            <div class="col-10 col-xl-8 py-3">

              <!-- Caja de logo con espacio reservado SIEMPRE -->
              <div class="logo-box mx-auto">
                <!-- Fallback mientras no carga o si falla -->
                <div class="logo-fallback" [class.hidden]="logoLoaded && !logoMissing" aria-hidden="true">
                  <svg viewBox="0 0 100 30" role="img" aria-label="Logo">
                    <rect x="0" y="0" width="100" height="30" rx="4" ry="4"></rect>
                    <text x="50" y="20" text-anchor="middle" font-size="12">LOGO</text>
                  </svg>
                </div>

                <!-- Imagen real -->
                <img
                  class="logo-img"
                  [class.loaded]="logoLoaded && !logoMissing"
                  [class.hidden]="logoMissing"
                  loading="eager"
                  decoding="sync"
                  src="assets/imagenes/cerjuslogo.jpg"
                  alt="Logo"
                  (load)="onLogoLoad()"
                  (error)="onLogoError()"
                />
              </div>
              <div class="abagado-box mx-auto">
                <!-- Fallback mientras no carga o si falla -->
                <div class="logo-fallback" [class.hidden]="logoLoaded && !logoMissing" aria-hidden="true">
                  <svg viewBox="0 0 100 30" role="img" aria-label="Logo">
                    <rect x="0" y="0" width="100" height="30" rx="4" ry="4"></rect>
                    <text x="50" y="20" text-anchor="middle" font-size="12">Abogado</text>
                  </svg>
                </div>

                <!-- Imagen real -->
                <img
                  class="logo-img"
                  [class.loaded]="logoLoaded && !logoMissing"
                  [class.hidden]="logoMissing"
                  loading="eager"
                  decoding="sync"
                  src="assets/imagenes/abogado.jpg"
                  alt="Logo"
                  (load)="onLogoLoad()"
                  (error)="onLogoError()"
                />
              </div>
              <hr class="border-primary-subtle mb-4">
              <h2 class="h1 mb-4">Bienvenido a CERJUS</h2>
              <p class="lead m-0">Por favor ingrese su correo y contraseña</p>
            </div>
          </div>
        </div>

        <!-- Columna derecha -->
        <div class="col-12 col-md-6">
          <div class="card-body p-3 p-md-4 p-xl-5">
            <div class="mb-5">
              <h3>Iniciar sesión</h3>
            </div>

            <form (ngSubmit)="onLogin()" #f="ngForm" autocomplete="on">
              <div class="row gy-3 gy-md-4 overflow-visible">

                <!-- EMAIL -->
                <div class="col-12">
                  <label for="email" class="form-label">Correo-electrónico <span class="text-danger">*</span></label>
                  <div class="input-shell">
                    <input
                      #emailInput
                      type="email"
                      class="form-control af-stable"
                      [(ngModel)]="email"
                      name="email"
                      id="email"
                      placeholder="nombre@gmail.com"
                      required
                      autocomplete="email"
                      spellcheck="false"
                      autocapitalize="off">
                    @if (!inputsReady) {
                      <div class="sk sk-input-overlay" aria-hidden="true"></div>
                    }
                  </div>
                </div>

                <!-- PASSWORD -->
                <div class="col-12">
                  <label for="password" class="form-label">Contraseña <span class="text-danger">*</span></label>
                  <div class="input-shell">
                    <input
                      #passwordInput
                      type="password"
                      class="form-control af-stable"
                      [(ngModel)]="password"
                      name="password"
                      id="password"
                      required
                      autocomplete="current-password"
                      spellcheck="false"
                      autocapitalize="off">
                    @if (!inputsReady) {
                      <div class="sk sk-input-overlay" aria-hidden="true"></div>
                    }
                  </div>
                </div>

                <div class="col-12">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="remember_me" id="remember_me" autocomplete="on">
                    <label class="form-check-label text-secondary" for="remember_me">
                      Mantener sesión
                    </label>
                  </div>
                </div>

                <div class="col-12">
                  <!-- altura reservada para errores -->
                  <p class="error-reserved" [class.visible]="!!error">{{ error || ' ' }}</p>
                </div>

                <div class="col-12">
                  <div class="d-grid">
                    <button class="btn btn-login btn-lg w-100" type="submit" [disabled]="f.invalid || loading">
                      Iniciar sesión
                    </button>
                  </div>
                </div>

              </div>
            </form>

            <hr class="mt-5 mb-4 border-secondary-subtle">
            <div class="d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-end">
              <a href="#!" class="link-secondary text-decoration-none">Olvidé mi contraseña</a>
              <a routerLink="registrar" class="link-secondary text-decoration-none">Registrarse</a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>